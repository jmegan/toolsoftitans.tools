!function(a){"use strict";var b=function(a){var c=a.h;if(!a.CORE_VERSION||!c.compareVersions(b.REQUIRE_CORE_VERSION,a.CORE_VERSION))throw new Error("[MixItUp Multifilter] MixItUp Multifilter v"+b.EXTENSION_VERSION+" requires at least MixItUp v"+b.REQUIRE_CORE_VERSION);a.ConfigMultifilter=function(){this.enable=!1,this.logicWithinGroup="or",this.logicBetweenGroups="and",this.minSearchLength=3,this.parseOn="change",this.keyupThrottleDuration=350,c.seal(this)},a.Config.registerAction("beforeConstruct","multifilter",function(){this.multifilter=new a.ConfigMultifilter}),a.MultifilterFormEventTracker=function(){this.form=null,this.totalBound=0,this.totalHandled=0,c.seal(this)},a.FilterGroupDom=function(){this.el=null,this.form=null,c.seal(this)},a.FilterGroup=function(){this.name="",this.dom=new a.FilterGroupDom,this.activeSelectors=[],this.activeToggles=[],this.handler=null,this.mixer=null,this.logic="or",this.parseOn="change",this.keyupTimeout=-1,c.seal(this)},c.extend(a.FilterGroup.prototype,{init:function(a,b){var c=this,d=a.getAttribute("data-logic");c.dom.el=a,this.name=c.dom.el.getAttribute("data-filter-group")||"",c.cacheDom(),c.dom.form&&c.enableButtons(),c.mixer=b,(d&&"and"===d.toLowerCase()||"and"===b.config.multifilter.logicWithinGroup)&&(c.logic="and"),c.bindEvents()},cacheDom:function(){var a=this;a.dom.form=c.closestParent(a.dom.el,"form",!0)},enableButtons:function(){var a=this,b=a.dom.form.querySelectorAll('button[type="submit"]:disabled'),c=null,d=-1;for(d=0;c=b[d];d++)c.disabled&&(c.disabled=!1)},bindEvents:function(){var a=this;a.handler=function(b){switch(b.type){case"reset":case"submit":a.handleFormEvent(b);break;default:a["handle"+c.pascalCase(b.type)](b)}},c.on(a.dom.el,"click",a.handler),c.on(a.dom.el,"change",a.handler),c.on(a.dom.el,"keyup",a.handler),a.dom.form&&(c.on(a.dom.form,"reset",a.handler),c.on(a.dom.form,"submit",a.handler))},unbindEvents:function(){var a=this;c.off(a.dom.el,"click",a.handler),c.off(a.dom.el,"change",a.handler),c.off(a.dom.el,"keyup",a.handler),a.dom.form&&(c.off(a.dom.form,"reset",a.handler),c.off(a.dom.form,"submit",a.handler)),a.handler=null},handleClick:function(a){var b=this,d=c.closestParent(a.target,"[data-filter], [data-toggle]",!0),e="",f=-1,g="";d&&((e=b.mixer.config.selectors.control)&&!d.matches(e)||(a.stopPropagation(),d.matches("[data-filter]")?(g=d.getAttribute("data-filter"),b.activeSelectors=[g]):d.matches("[data-toggle]")&&(g=d.getAttribute("data-toggle"),(f=b.activeToggles.indexOf(g))>-1?b.activeToggles.splice(f,1):b.activeToggles.push(g),"and"===b.logic?b.activeSelectors=[b.activeToggles]:b.activeSelectors=b.activeToggles),b.updateControls(),"change"===b.mixer.config.multifilter.parseOn&&b.mixer.parseFilterGroups()))},handleChange:function(a){var b=this,c=a.target;switch(a.stopPropagation(),c.type){case"text":case"search":case"password":case"select-one":case"radio":b.getSingleValue(c);break;case"checkbox":case"select-multiple":b.getMultipleValues(c)}"change"===b.mixer.config.multifilter.parseOn&&b.mixer.parseFilterGroups()},handleKeyup:function(a){var b=this,c=a.target;return"change"!==b.mixer.config.multifilter.parseOn?void b.mixer.getSingleValue(c):(clearTimeout(b.keyupTimeout),void(b.keyupTimeout=setTimeout(function(){b.getSingleValue(c),b.mixer.parseFilterGroups()},b.mixer.config.multifilter.keyupThrottleDuration)))},handleFormEvent:function(b){var c=this,d=null,e=null,f=-1;if("submit"===b.type&&b.preventDefault(),"reset"===b.type&&(c.activeToggles=[],c.activeSelectors=[],c.updateControls()),c.mixer.multifilterFormEventTracker)d=c.mixer.multifilterFormEventTracker;else for(d=c.mixer.multifilterFormEventTracker=new a.MultifilterFormEventTracker,d.form=b.target,f=0;e=c.mixer.filterGroups[f];f++)e.dom.form===b.target&&d.totalBound++;b.target===d.form&&(d.totalHandled++,d.totalHandled===d.totalBound&&(c.mixer.multifilterFormEventTracker=null,"submit"!==b.type&&"change"!==c.mixer.config.multifilter.parseOn||c.mixer.parseFilterGroups()))},getSingleValue:function(a){var b=this,c="",d="",e="";if(a.type.match(/text|search|password/g)){if(c=a.getAttribute("data-search-attribute"),!c)throw new Error("[MixItUp MultiFilter] A valid `data-search-attribute` must be present on text inputs");if(a.value.length<b.mixer.config.multifilter.minSearchLength)return void(b.activeSelectors=[""]);e=a.value.replace(/\W+/g," ").toLowerCase().trim(),d="["+c+'*="'+e+'"]'}else d=a.value;"string"==typeof a.value&&(b.activeSelectors=[d])},getMultipleValues:function(a){var b=this,c=[],d="",e=null,f=null,g=-1;switch(a.type){case"checkbox":d='input[type="checkbox"]';break;case"select-multiple":d="option"}for(f=b.dom.el.querySelectorAll(d),g=0;e=f[g];g++)(e.checked||e.selected)&&e.value&&c.push(e.value);"and"===b.logic&&(c=[c]),b.activeSelectors=c},updateControls:function(a,b){var c=this,d=null,e="filter",f=-1;for(a=a||c.dom.el.querySelectorAll("[data-filter], [data-toggle]"),b=b||!1,f=0;d=a[f];f++)d.getAttribute("data-toggle")&&(e="toggle"),c.updateControl(d,e,b)},updateControl:function(a,b,d){var e=this,f=a.getAttribute("data-"+b),g="";g=c.getClassname(e.mixer.config.classNames,b,e.mixer.config.classNames.modifierActive),e.activeSelectors.indexOf(f)>-1?(c.addClass(a,g),d&&e.activeToggles.push(f)):c.removeClass(a,g)},updateUi:function(){var a=this,b=a.dom.el.querySelectorAll("[data-filter], [data-toggle]"),c=a.dom.el.querySelectorAll('input[type="radio"], input[type="checkbox"], option'),d=!1,e=null,f=-1;for(b.length&&(a.activeToggles=[],a.updateControls(b,!0)),f=0;e=c[f];f++)switch(d=a.activeSelectors.indexOf(e.value)>-1,e.tagName.toLowerCase()){case"option":e.selected=d;break;case"input":e.checked=d}}}),a.MixerDom.registerAction("afterConstruct","multifilter",function(){this.filterGroups=[]}),a.Mixer.registerAction("afterConstruct","multifilter",function(){this.filterGroups=[],this.filterGroupsHash={},this.multifilterFormEventTracker=null}),a.Mixer.registerAction("afterCacheDom","multifilter",function(){var b=this,c=null;if(b.config.multifilter.enable){switch(b.config.controls.scope){case"local":c=b.dom.container;break;case"global":c=b.dom.document;break;default:throw new Error(a.messages.ERROR_CONFIG_INVALID_CONTROLS_SCOPE)}b.dom.filterGroups=c.querySelectorAll("[data-filter-group]")}}),a.Mixer.registerAction("beforeInitControls","multifilter",function(){var a=this;a.config.multifilter.enable&&(a.config.controls.live=!0)}),a.Mixer.registerAction("afterSanitizeConfig","multifilter",function(){var a=this;a.config.multifilter.logicBetweenGroups=a.config.multifilter.logicBetweenGroups.toLowerCase().trim(),a.config.multifilter.logicWithinGroup=a.config.multifilter.logicWithinGroup.toLowerCase().trim()}),a.Mixer.registerAction("afterAttach","multifilter",function(){var a=this;a.dom.filterGroups.length&&a.indexFilterGroups()}),a.Mixer.registerAction("afterUpdateControls","multifilter",function(){var a=this,b=null,c=-1;for(c=0;b=a.filterGroups[c];c++)b.updateControls()}),a.Mixer.registerAction("beforeDestroy","multifilter",function(){var a=this,b=null,c=-1;for(c=0;b=a.filterGroups[c];c++)b.unbindEvents()}),a.Mixer.extend({indexFilterGroups:function(){var b=this,c=null,d=null,e=-1;for(e=0;d=b.dom.filterGroups[e];e++)if(c=new a.FilterGroup,c.init(d,b),b.filterGroups.push(c),c.name){if("undefined"!=typeof b.filterGroupsHash[c.name])throw new Error('[MixItUp MultiFilter] A filter group with name "'+c.name+'" already exists');b.filterGroupsHash[c.name]=c}},parseParseFilterGroupsArgs:function(b){var d=this,e=new a.UserInstruction,f=null,g=-1;for(e.animate=d.config.animation.enable,e.command=new a.CommandFilter,g=0;g<b.length;g++)f=b[g],"boolean"==typeof f?e.animate=f:"function"==typeof f&&(e.callback=f);return c.freeze(e),e},getFilterGroupPaths:function(){var a=this,b=null,d=null,e=null,f=[],g=[],h=[],i=-1;for(i=0;i<a.filterGroups.length;i++)(e=a.filterGroups[i].activeSelectors).length&&(f.push(e),h.push(0));return b=function(){var a=null,b=[],d=-1;for(d=0;d<f.length;d++)a=f[d][h[d]],Array.isArray(a)&&(a=a.join("")),b.push(a);b=c.clean(b),g.push(b)},d=function(a){a=a||0;for(var c=f[a];h[a]<c.length;)a<f.length-1?d(a+1):b(),h[a]++;h[a]=0},f.length?(d(),g):""},buildSelectorFromPaths:function(a){var b=this,c=null,d=[],e="",f="",g=-1;if(!a.length)return"";if("or"===b.config.multifilter.logicBetweenGroups&&(f=", "),a.length>1){for(g=0;g<a.length;g++)c=a[g],e=c.join(f),d.indexOf(e)<0&&d.push(e);return d.join(", ")}return a[0].join(f)},parseFilterGroups:function(){var a=this,b=a.parseFilterArgs(arguments),c=a.getFilterGroupPaths(),d=a.buildSelectorFromPaths(c);return""===d&&(d=a.config.controls.toggleDefault),b.command.selector=d,a.multimix({filter:b.command},b.animate,b.callback)},setFilterGroupSelectors:function(a,b){var c=this,d=null;if(b=Array.isArray(b)?b:[b],"undefined"==typeof(d=c.filterGroupsHash[a]))throw new Error('[MixItUp MultiFilter] No filter group could be found with the name "'+a+'"');d.activeSelectors=b.slice(),d.updateUi()},getFilterGroupSelectors:function(a){var b=this,c=null;if("undefined"==typeof(c=b.filterGroupsHash[a]))throw new Error('[MixItUp MultiFilter] No filter group could be found with the name "'+a+'"');return c.activeSelectors.slice()}}),a.Facade.registerAction("afterConstruct","multifilter",function(a){this.parseFilterGroups=a.parseFilterGroups.bind(a),this.setFilterGroupSelectors=a.setFilterGroupSelectors.bind(a),this.getFilterGroupSelectors=a.getFilterGroupSelectors.bind(a)})};if(b.TYPE="mixitup-extension",b.NAME="mixitup-multifilter",b.EXTENSION_VERSION="3.2.0",b.REQUIRE_CORE_VERSION="^3.1.2","object"==typeof exports&&"object"==typeof module)module.exports=b;else if("function"==typeof define&&define.amd)define(function(){return b});else{if(!a.mixitup||"function"!=typeof a.mixitup)throw new Error("[MixItUp MultiFilter] MixItUp core not found");b(a.mixitup)}}(window);